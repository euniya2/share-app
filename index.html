<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ë°˜ HTML ë§í¬ ìƒì„±ê¸°</title>
    <!-- ìŠ¤íƒ€ì¼ ê¾¸ë¯¸ê¸° (Tailwind CSS) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- URL ì••ì¶• ë¼ì´ë¸ŒëŸ¬ë¦¬ (LZ-String) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .editor-container { height: calc(100vh - 200px); }
    </style>
</head>
<body class="bg-slate-100 min-h-screen">

    <!-- 1. ë©”ì¸ í™”ë©´ (ì—ë””í„°) -->
    <div id="app-ui" class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-slate-800 mb-2">ğŸš€ ìš°ë¦¬ë°˜ ì›¹ì‚¬ì´íŠ¸ ë°°í¬ê¸°</h1>
            <p class="text-slate-600">ì‘ì„±í•œ HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ê³  ì¹œêµ¬ë“¤ì—ê²Œ ê³µìœ í•  ì£¼ì†Œë¥¼ ë§Œë“œì„¸ìš”.</p>
        </header>

        <div class="bg-white rounded-xl shadow-lg p-6">
            <label class="block text-slate-700 font-bold mb-2"> ì—¬ê¸°ì— ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš” ğŸ‘‡</label>
            <div class="editor-container mb-4">
                <textarea id="source-code" 
                    class="w-full h-full p-4 border border-slate-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none"
                    placeholder="<html>...</html>"></textarea>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                <button onclick="previewCode()" class="px-6 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition w-full sm:w-auto">
                    ë¯¸ë¦¬ë³´ê¸°
                </button>
                <button onclick="generateLink()" class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow transition w-full sm:w-auto">
                    âœ¨ ê³µìœ  ë§í¬ ìƒì„±í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- ê²°ê³¼ ë§í¬ í‘œì‹œ ì˜ì—­ -->
        <div id="result-area" class="hidden mt-6 bg-green-50 border border-green-200 rounded-xl p-6 text-center animate-bounce-in">
            <h3 class="text-green-800 font-bold text-lg mb-2">ğŸ‰ ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
            <p class="text-sm text-green-700 mb-4">ì•„ë˜ ì£¼ì†Œë¥¼ ë³µì‚¬í•´ì„œ ì¹œêµ¬ì—ê²Œ ë³´ë‚´ì„¸ìš”.</p>
            
            <div class="flex items-center gap-2 bg-white border border-green-300 rounded-lg p-2 mb-4">
                <input type="text" id="share-link" readonly class="w-full bg-transparent outline-none text-slate-600 text-sm px-2">
                <button onclick="copyLink()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-1.5 rounded text-sm whitespace-nowrap">
                    ë³µì‚¬
                </button>
            </div>
            
            <a id="preview-btn" href="#" target="_blank" class="inline-block text-green-600 underline text-sm hover:text-green-800">
                ìƒˆ ì°½ì—ì„œ í™•ì¸í•˜ê¸° &rarr;
            </a>
        </div>
    </div>

    <!-- ìŠ¤í¬ë¦½íŠ¸ ë¡œì§ -->
    <script>
        // 1. í˜ì´ì§€ ë¡œë“œ ì‹œ: URLì— ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë°”ë¡œ ê·¸ í™”ë©´ì„ ë³´ì—¬ì¤Œ (ë·°ì–´ ëª¨ë“œ)
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const compressed = params.get('data');

            if (compressed) {
                // ì••ì¶•ëœ ë°ì´í„°ê°€ ìˆë‹¤ë©´ -> ì••ì¶•ì„ í’€ê³  í™”ë©´ì„ êµì²´
                try {
                    const decompressed = LZString.decompressFromEncodedURIComponent(compressed);
                    if (decompressed) {
                        document.open();
                        document.write(decompressed);
                        document.close();
                    } else {
                        alert("ì½”ë“œë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    }
                } catch (e) {
                    console.error(e);
                    alert("ì˜ëª»ëœ ë§í¬ì…ë‹ˆë‹¤.");
                }
            } else {
                // ë°ì´í„°ê°€ ì—†ë‹¤ë©´ -> ì—ë””í„° ëª¨ë“œ ìœ ì§€
                // ê¸°ë³¸ ì˜ˆì œ ì½”ë“œ ë„£ì–´ì£¼ê¸°
                document.getElementById('source-code').value = 
`<!DOCTYPE html>
<html>
<head>
    <style>
        body { background-color: #f0f9ff; text-align: center; padding: 50px; font-family: sans-serif; }
        h1 { color: #0284c7; }
        .box { background: white; padding: 20px; border-radius: 10px; display: inline-block; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <div class="box">
        <h1>ì•ˆë…•! ë‚´ í™ˆí˜ì´ì§€ì•¼ ğŸ‘‹</h1>
        <p>ì„ ìƒë‹˜ì´ ë§Œë“¤ì–´ì¤€ ë„êµ¬ë¡œ ë§Œë“¤ì—ˆì–´.</p>
    </div>
</body>
</html>`;
            }
        };

        // 2. ë§í¬ ìƒì„± í•¨ìˆ˜
        function generateLink() {
            const code = document.getElementById('source-code').value;
            if (!code.trim()) {
                alert("ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }

            // ì½”ë“œ ì••ì¶•
            const compressed = LZString.compressToEncodedURIComponent(code);
            
            // í˜„ì¬ ì‚¬ì´íŠ¸ ì£¼ì†Œ + ?data=ì••ì¶•ëœì½”ë“œ
            const currentUrl = window.location.href.split('?')[0];
            const fullUrl = `${currentUrl}?data=${compressed}`;

            // URL ê¸¸ì´ ì²´í¬ (ë¸Œë¼ìš°ì € í•œê³„ ê³ ë ¤)
            if (fullUrl.length > 8000) {
                alert("ì½”ë“œê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤! ì´ë¯¸ì§€ë¥¼ ì¤„ì´ê±°ë‚˜ ì½”ë“œë¥¼ ì¡°ê¸ˆ ì¤„ì—¬ì£¼ì„¸ìš”.");
                return;
            }

            // ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
            const resultArea = document.getElementById('result-area');
            const linkInput = document.getElementById('share-link');
            const previewBtn = document.getElementById('preview-btn');

            resultArea.classList.remove('hidden');
            linkInput.value = fullUrl;
            previewBtn.href = fullUrl;

            // í™”ë©´ ìŠ¤í¬ë¡¤ ì´ë™
            resultArea.scrollIntoView({ behavior: 'smooth' });
        }

        // 3. ë³µì‚¬ ë²„íŠ¼
        function copyLink() {
            const copyText = document.getElementById("share-link");
            copyText.select();
            document.execCommand("copy");
            alert("ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹œêµ¬ì—ê²Œ ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.");
        }

        // 4. ë¯¸ë¦¬ë³´ê¸° (ìƒˆ ì°½ ì—´ì–´ì„œ í…ŒìŠ¤íŠ¸)
        function previewCode() {
            const code = document.getElementById('source-code').value;
            const newWindow = window.open();
            newWindow.document.write(code);
            newWindow.document.close();
        }
    </script>
</body>
</html>
